{% load static %}
<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Crear cuenta — RC</title>
  <link rel="icon" href="{% static 'img/favicon.png' %}" type="image/png">
  <link rel="stylesheet" href="{% static 'accounts/styles.css' %}">
</head>
<body>
  <header class="site-topbar">
    <a class="brand" href="#" aria-label="Rodolfo Castellón">RC</a>
    <div class="theme-toggle" id="themeToggle">
      <input type="radio" name="t" id="t-light" value="light" checked>
      <label class="toggle-chip" for="t-light">Claro</label>
      <input type="radio" name="t" id="t-dark" value="dark">
      <label class="toggle-chip" for="t-dark">Oscuro</label>
    </div>
  </header>

  <main class="site-main">
    <section class="auth-hero">
      <div class="glow-card">
        <div class="login-card">
          <div class="card-head">
            <div class="logo">RC</div>
            <h1 class="title">Crear cuenta</h1>
            <p class="subtitle">Regístrate para agendar y gestionar tus citas</p>
          </div>

          <form method="post" class="auth-form" action="{% url 'accounts:register' %}" autocomplete="off">
            {% csrf_token %}
            <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

            {% if form.non_field_errors %}
              <div class="form-errors">
                {% for error in form.non_field_errors %}
                  <span class="error-text">{{ error }}</span>
                {% endfor %}
              </div>
            {% endif %}

            {% if form.errors %}
              {% for field in form %}
                {% if field.errors %}
                  <div class="form-errors">
                    <strong>{{ field.label }}:</strong>
                    {% for error in field.errors %}
                      <span class="error-text">{{ error }}</span>
                    {% endfor %}
                  </div>
                {% endif %}
              {% endfor %}
            {% endif %}


            <div class="field">
              <label for="id_username" class="muted">Usuario</label>
              <input id="id_username" class="input" type="text" name="username"
                     required 
                     maxlength="25" 
                     pattern="[a-zA-Z0-9]+"
                     title="Solo letras y números, máximo 25 caracteres."
                     autocomplete="username"
                     placeholder="ej. juanperez" value="{{ form.username.value|default:'' }}">
              {% for error in form.username.errors %}
                <span class="error-text">{{ error }}</span>
              {% endfor %}
            </div>

            <div class="field">
              <label for="id_first_name" class="muted">Nombre</label>
              <input id="id_first_name" class="input" type="text" name="first_name"
                     required
                     minlength="4"   maxlength="25"
                     pattern="[a-zA-Z\sñÑáéíóúÁÉÍÓÚüÜ]+"
                     title="Solo letras (mínimo 4, máximo 25 caracteres)." placeholder="ej. Juan" value="{{ form.first_name.value|default:'' }}">
              {% for error in form.first_name.errors %}
                <span class="error-text">{{ error }}</span>
              {% endfor %}
            </div>
            
            <div class="field">
              <label for="id_last_name" class="muted">Apellido</label>
              <input id="id_last_name" class="input" type="text" name="last_name"
                     required
                     minlength="4"   maxlength="25"
                     pattern="[a-zA-Z\sñÑáéíóúÁÉÍÓÚüÜ]+"
                     title="Solo letras (mínimo 4, máximo 25 caracteres)." placeholder="ej. Pérez" value="{{ form.last_name.value|default:'' }}">
              {% for error in form.last_name.errors %}
                <span class="error-text">{{ error }}</span>
              {% endfor %}
            </div>

            
            <div class="field">
              <label for="id_telefono" class="muted">Teléfono</label>
              <input id="id_telefono" class="input" type="tel" name="telefono"
                     required
                     minlength="10"
                     maxlength="10"
                     pattern="[0-9]{10}"
                     title="El teléfono debe tener exactamente 10 números."
                     placeholder="ej. 3221234567" value="{{ form.telefono.value|default:'' }}">
              {% for error in form.telefono.errors %}
                <span class="error-text">{{ error }}</span>
              {% endfor %}
            </div>

            <div class="field">
              <label for="id_email" class="muted">Correo (opcional)</label>
              <input id="id_email" class="input" type="email" name="email"
                     autocomplete="email" placeholder="ej. juan@correo.com" value="{{ form.email.value|default:'' }}">
              {% for error in form.email.errors %}
                <span class="error-text">{{ error }}</span>
              {% endfor %}
            </div>

            <div class="field">
              <label for="id_password1" class="muted">Contraseña</label>
              <input id="id_password1" class="input" type="password" name="password1"
                     required autocomplete="new-password" placeholder="Mínimo 8 caracteres">
            </div>

            <div class="field" style="margin-bottom:.75rem;">
              <label for="id_password2" class="muted">Repite contraseña</label>
              <input id="id_password2" class="input" type="password" name="password2"
                     required autocomplete="new-password">
            </div>

            <button class="btn btn-primary w-100" type="submit">Crear cuenta</button>

            {% if messages %}
              <ul style="margin-top:.75rem; padding-left:16px; color:#27ae60;">
                {% for m in messages %}
                  <li>{{ m }}</li>
                {% endfor %}
              </ul>
            {% endif %}

            <p class="form-meta" style="margin-top:1rem;">
              ¿Ya tienes una cuenta?
              <a class="link" href="{% url 'accounts:login' %}">Inicia sesión</a>
            </p>
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">© Consultorio Rodolfo Castellón</footer>
  <script src="{% static 'accounts/app.js' %}"></script>
</body>
</html>
