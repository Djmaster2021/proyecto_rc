{% extends "dentista/base.html" %}
{% load static %}

{% block dtitle %}Dashboard{% endblock %}

{% block dcontent %}
<section class="dx-scope" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1rem">
  <article class="card" style="padding:1rem;background:#fff;border:1px solid #e5e7eb;border-radius:12px">🗓️ <strong>12</strong> Citas de hoy</article>
  <article class="card" style="padding:1rem;background:#fff;border:1px solid #e5e7eb;border-radius:12px">👥 <strong>48</strong> Pacientes activos</article>
  <article class="card" style="padding:1rem;background:#fff;border:1px solid #e5e7eb;border-radius:12px">💰 <strong>$7,250</strong> Ingresos esta semana</article>

  <article class="card" style="padding:1rem;background:#fff;border:1px solid #e5e7eb;border-radius:12px;min-height:260px">
    <h3 style="margin:0 0 .5rem">Citas por día</h3>
    <div class="chart-wrap"><canvas id="chartCitas"></canvas></div>
  </article>
  
  <article class="card" style="padding:1rem;background:#fff;border:1px solid #e5e7eb;border-radius:12px">
    <h3 style="margin:0 0 .5rem">Últimos pacientes</h3>
    <div class="table-wrap">
      <table style="width:100%;border-collapse:collapse">
        <thead>
          <tr><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:.6rem">Hora</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:.6rem">Paciente</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:.6rem">Motivo</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:.6rem">Estado</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:.6rem">Pago</th></tr>
        </thead>
        <tbody>
          <tr><td style="border-bottom:1px solid #e5e7eb;padding:.6rem">10:00</td><td style="border-bottom:1px solid #e5e7eb;padding:.6rem">Ana López</td><td style="border-bottom:1px solid #e5e7eb;padding:.6rem">Limpieza</td><td style="border-bottom:1px solid #e5e7eb;padding:.6rem">Pendiente</td><td style="border-bottom:1px solid #e5e7eb;padding:.6rem">Pendiente</td></tr>
          <tr><td style="padding:.6rem">11:00</td><td style="padding:.6rem">Juan Pérez</td><td style="padding:.6rem">Extracción</td><td style="padding:.6rem">Atendido</td><td style="padding:.6rem">Pagado</td></tr>
        </tbody>
      </table>
    </div>
  </article>
</section>

<!-- Chart.js solo aquí (pagos ya lo incluye en su propia vista) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
{% endblock %}

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const el = document.getElementById('chartCitas');
    if(!el || !window.Chart) return;
  
    new Chart(el, {
      type: 'line',
      data: {
        labels: ['Lun','Mar','Mié','Jue','Vie','Sáb','Dom'],
        datasets: [{
          label: 'Citas',
          data: [3,5,4,7,6,2,1],
          tension:.35,
          fill:true,
          pointRadius:0
        }]
      },
      options: {
        responsive:true,
        maintainAspectRatio:false,
        scales:{
          x:{ ticks:{ autoSkip:true } },
          y:{ beginAtZero:true }
        }
      }
    });
  });
  </script>
  